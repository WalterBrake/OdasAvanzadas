include ../../assets/pug/_head
include ../../assets/pug/_scripts

- title = 'Mis propias decisiones'

<!DOCTYPE html>
html(lang="es")
    +head
        style.
            .map lottie-player{
                position: absolute;
                left: 0; right: 0;
                bottom: 0; top: 0;
                width: 100%;
                height: 100%;
            }

    body
        #app
            // START
            scene(v-if="currentScene==0" :key="0" start-scene @completed="sceneCompleted")

            // SCENES
            scene(v-if="currentScene==1" hidescorebox :key="1" :score="scoreInScene" :temporals="temporals" alloks alloks-sound="../../assets/asound/bienhecho_mujer.mp3" @completed="sceneCompleted" :devmode="$devmode" :answers="1" scene-color="#ED1C25")
                //info(type="seleccionar" title=title text="Lee la nota informativa." textaudio="s/instruccion1.mp3" :autoplay="true")
                activity
                    .row.w100.info: h1=title    
                    audiotext(audio="s/instruccion1.mp3" :autoplay="true" @completed="temps.a=true" text="En la vida cotidiana hay acciones que puedes hacer por ti mismo y otras en las que necesitas el acompañamiento de un adulto, es muy importante tener en cuenta esto para que los adultos te proporcionamos esa ayuda y puedas realizar o formar parte de estas actividades.")
                    .w30.wm50
                        lottie-player(src="i/talk.json" key="l1" background="transparent" speed="1" style="width: 100%; height: 100%;" loop autoplay v-if="!temps.a")
                        lottie-player(src="i/talk.json" key="l1" background="transparent" speed="1" style="width: 100%; height: 100%;" v-else)
                    .row.w100(v-if="temps.a"): button(@click="sceneCompleted(false)").button.big Siguiente
            
            
            
            // SCENES - calle
            scene(v-for="(i, index) in temps.allscenes"  v-if="currentScene==index+2"  :key="index+2" :score="scoreInScene" :temporals="temporals" alloks alloks-sound="../../assets/asound/bienhecho_mujer.mp3" @completed="sceneCompleted" :devmode="$devmode" :answers="1" scene-color="#ED1C25")
                info(type="dragdrop" title=title text="Selecciona si cada una de las acciones las puedes hacer solo o si las debes hacer acompañado de un adulto." textaudio="s/instruccion2.mp3" :autoplay="index == 0")
                activity
                    template(v-if="!i.animation")
                        img(:src="i.img").w30.wm50
                        .row.wrap.around.text-center
                            
                            template(v-if="i.answer == 'adulto'")
                                .w30.wm50: clickable(:isok="true" simple-ok initclass="pa-1" click-sound="s/adulto.mp3" ext-validation @itsok="oknext(index)")
                                    img(src="i/adulto.png" ).w100
                                    .text-center Puedo hacerlo con un adulto.
                                
                                .w30.wm50: clickable(:isok="false" simple-ok initclass="pa-1")
                                    img(src="i/solo.png"  ignore-already-ok ext-validation).w100
                                    .text-center Puedo hacerlo solo.
                                
                            
                            template(v-if="i.answer == 'solo'")
                                .w30.wm50: clickable(:isok="false" simple-ok initclass="pa-1")
                                    img(src="i/adulto.png" ).w100
                                    .text-center Puedo hacerlo con un adulto.
                                
                                .w30.wm50: clickable(:isok="true" simple-ok initclass="pa-1" click-sound="s/solo.mp3"  ext-validation @itsok="oknext(index)")
                                    img(src="i/solo.png"  ignore-already-ok ext-validation).w100
                                    .text-center Puedo hacerlo solo.

                    template(v-else)
                        .map.relative.w60
                            img(src="i/bg.png").w100
                            lottie-player(:src="i.lottie" :key="'lott'+index" background="transparent" speed="1" style="width: 100%; height: 100%;" autoplay loop)
                        .row.w100: button(@click="nextScene").button.big Siguiente
            
            // SCENES
            scene(v-if="currentScene==8" hidescorebox :key="8" :score="scoreInScene" :temporals="temporals" alloks alloks-sound="../../assets/asound/bienhecho_mujer.mp3" @completed="sceneCompleted" :devmode="$devmode" :answers="1" scene-color="#ED1C25")
                info(type="seleccionar" title=title text="" :autoplay="false")
                activity
                    audiotext(audio="s/cierre.mp3" :autoplay="true" @completed="temps.a=true" text="¡Muy bien! Recuerda pedir ayuda a los adultos cuando es necesario.")
                    .w30.wm50
                        lottie-player(src="i/talk.json" key="l1" background="transparent" speed="1" style="width: 100%; height: 100%;" loop autoplay v-if="!temps.a")
                        lottie-player(src="i/talk.json" key="l1" background="transparent" speed="1" style="width: 100%; height: 100%;" v-else)
                    .row.w100(v-if="temps.a"): button(@click="sceneCompleted(false)").button.big Finalizar
            
       
            
            // END
            scene(v-if="currentScene==9" :key="9" end-scene :final-data="finalData")
        
        +scripts

            script.
                app.$devmode = false
                
                
                
                app.$set(app.temps, 'allscenes', [
                    {animation: false, answer: 'adulto', img: 'i/tag_calle.svg', lottie: 'i/calle.json'},
                    {animation: false, answer: 'solo', img: 'i/tag_banarme.svg', lottie: 'i/banarme.json'},
                    {animation: false, answer: 'solo', img: 'i/tag_vestirme.svg', lottie: 'i/vestirme.json'},
                    {animation: false, answer: 'adulto', img: 'i/tag_escuela.svg', lottie: 'i/escuela.json'},
                    {animation: false, answer: 'adulto', img: 'i/tag_comida.svg', lottie: 'i/comida.json'},
                    {animation: false, answer: 'solo', img: 'i/tag_dientes.svg', lottie: 'i/dientes.json'},
                ])
                
                
                app.$set(app.temps, 'a', false)
 
                
                app.currentScene = 0
                app.scenesCount = 6

                app.oknext = function (inx) {
                    app.temps.allscenes[inx].animation = true
                    s_ok.play()
                }
                app.nextScene = function () {
                    EventBus.$emit('isok')
                }